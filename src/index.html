<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width">
    <link rel="icon"
        href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2c4.97 0 9 3.99 9 8.9 0 3.26-2.72 6.7-8.05 10.44L12 22l-.57-.4C5.85 17.77 3 14.24 3 10.9 3 6 7.03 2 12 2Zm0 1.98c-3.87 0-7 3.1-7 6.92 0 2.4 2.3 5.34 7 8.68 4.7-3.34 7-6.28 7-8.68a6.96 6.96 0 0 0-7-6.92ZM12 6a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"/></svg>'>
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" crossorigin="anonymous">
    <style>
        :root,
        :host {
            --ol-background-color: white;
            --ol-accent-background-color: #F5F5F5;
            --ol-subtle-background-color: rgba(128, 128, 128, 0.25);
            --ol-partial-background-color: rgba(255, 255, 255, 0.75);
            --ol-foreground-color: #333333;
            --ol-subtle-foreground-color: #666666;
            --ol-brand-color: #00AAFF;
        }

        .ol-box {
            box-sizing: border-box;
            border-radius: 2px;
            border: 1.5px solid var(--ol-background-color);
            background-color: var(--ol-partial-background-color);
        }

        .ol-mouse-position {
            top: 8px;
            right: 8px;
            position: absolute;
        }

        .ol-scale-line {
            background: var(--ol-partial-background-color);
            border-radius: 4px;
            bottom: 8px;
            left: 8px;
            padding: 2px;
            position: absolute;
        }

        .ol-scale-line-inner {
            border: 1px solid var(--ol-subtle-foreground-color);
            border-top: none;
            color: var(--ol-foreground-color);
            font-size: 10px;
            text-align: center;
            margin: 1px;
            will-change: contents, width;
            transition: all 0.25s;
        }

        .ol-scale-bar {
            position: absolute;
            bottom: 8px;
            left: 8px;
        }

        .ol-scale-bar-inner {
            display: flex;
        }

        .ol-scale-step-marker {
            width: 1px;
            height: 15px;
            background-color: var(--ol-foreground-color);
            float: right;
            z-index: 10;
        }

        .ol-scale-step-text {
            position: absolute;
            bottom: -5px;
            font-size: 10px;
            z-index: 11;
            color: var(--ol-foreground-color);
            text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);
        }

        .ol-scale-text {
            position: absolute;
            font-size: 12px;
            text-align: center;
            bottom: 25px;
            color: var(--ol-foreground-color);
            text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);
        }

        .ol-scale-singlebar {
            position: relative;
            height: 10px;
            z-index: 9;
            box-sizing: border-box;
            border: 1px solid var(--ol-foreground-color);
        }

        .ol-scale-singlebar-even {
            background-color: var(--ol-subtle-foreground-color);
        }

        .ol-scale-singlebar-odd {
            background-color: var(--ol-background-color);
        }

        .ol-unsupported {
            display: none;
        }

        .ol-viewport,
        .ol-unselectable {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .ol-viewport canvas {
            all: unset;
            overflow: hidden;
        }

        .ol-viewport {
            touch-action: pan-x pan-y;
        }

        .ol-selectable {
            -webkit-touch-callout: default;
            -webkit-user-select: text;
            -moz-user-select: text;
            user-select: text;
        }

        .ol-grabbing {
            cursor: -webkit-grabbing;
            cursor: -moz-grabbing;
            cursor: grabbing;
        }

        .ol-grab {
            cursor: move;
            cursor: -webkit-grab;
            cursor: -moz-grab;
            cursor: grab;
        }

        .ol-control {
            position: absolute;
            background-color: var(--ol-subtle-background-color);
            border-radius: 4px;
        }

        .ol-zoom {
            top: .5em;
            left: .5em;
        }

        .ol-rotate {
            top: .5em;
            right: .5em;
            transition: opacity .25s linear, visibility 0s linear;
        }

        .ol-rotate.ol-hidden {
            opacity: 0;
            visibility: hidden;
            transition: opacity .25s linear, visibility 0s linear .25s;
        }

        .ol-zoom-extent {
            top: 4.643em;
            left: .5em;
        }

        .ol-full-screen {
            right: .5em;
            top: .5em;
        }

        .ol-control button {
            display: block;
            margin: 1px;
            padding: 0;
            color: var(--ol-subtle-foreground-color);
            font-weight: bold;
            text-decoration: none;
            font-size: inherit;
            text-align: center;
            height: 1.375em;
            width: 1.375em;
            line-height: .4em;
            background-color: var(--ol-background-color);
            border: none;
            border-radius: 2px;
        }

        .ol-control button::-moz-focus-inner {
            border: none;
            padding: 0;
        }

        .ol-zoom-extent button {
            line-height: 1.4em;
        }

        .ol-compass {
            display: block;
            font-weight: normal;
            will-change: transform;
        }

        .ol-touch .ol-control button {
            font-size: 1.5em;
        }

        .ol-touch .ol-zoom-extent {
            top: 5.5em;
        }

        .ol-control button:hover,
        .ol-control button:focus {
            text-decoration: none;
            outline: 1px solid var(--ol-subtle-foreground-color);
            color: var(--ol-foreground-color);
        }

        .ol-zoom .ol-zoom-in {
            border-radius: 2px 2px 0 0;
        }

        .ol-zoom .ol-zoom-out {
            border-radius: 0 0 2px 2px;
        }

        .ol-attribution {
            text-align: right;
            bottom: .5em;
            right: .5em;
            max-width: calc(100% - 1.3em);
            display: flex;
            flex-flow: row-reverse;
            align-items: center;
        }

        .ol-attribution a {
            color: var(--ol-subtle-foreground-color);
            text-decoration: none;
        }

        .ol-attribution ul {
            margin: 0;
            padding: 1px .5em;
            color: var(--ol-foreground-color);
            text-shadow: 0 0 2px var(--ol-background-color);
            font-size: 12px;
        }

        .ol-attribution li {
            display: inline;
            list-style: none;
        }

        .ol-attribution li:not(:last-child):after {
            content: " ";
        }

        .ol-attribution img {
            max-height: 2em;
            max-width: inherit;
            vertical-align: middle;
        }

        .ol-attribution button {
            flex-shrink: 0;
        }

        .ol-attribution.ol-collapsed ul {
            display: none;
        }

        .ol-attribution:not(.ol-collapsed) {
            background: var(--ol-partial-background-color);
        }

        .ol-attribution.ol-uncollapsible {
            bottom: 0;
            right: 0;
            border-radius: 4px 0 0;
        }

        .ol-attribution.ol-uncollapsible img {
            margin-top: -.2em;
            max-height: 1.6em;
        }

        .ol-attribution.ol-uncollapsible button {
            display: none;
        }

        .ol-zoomslider {
            top: 4.5em;
            left: .5em;
            height: 200px;
        }

        .ol-zoomslider button {
            position: relative;
            height: 10px;
        }

        .ol-touch .ol-zoomslider {
            top: 5.5em;
        }

        .ol-overviewmap {
            left: 0.5em;
            bottom: 0.5em;
        }

        .ol-overviewmap.ol-uncollapsible {
            bottom: 0;
            left: 0;
            border-radius: 0 4px 0 0;
        }

        .ol-overviewmap .ol-overviewmap-map,
        .ol-overviewmap button {
            display: block;
        }

        .ol-overviewmap .ol-overviewmap-map {
            border: 1px solid var(--ol-subtle-foreground-color);
            height: 150px;
            width: 150px;
        }

        .ol-overviewmap:not(.ol-collapsed) button {
            bottom: 0;
            left: 0;
            position: absolute;
        }

        .ol-overviewmap.ol-collapsed .ol-overviewmap-map,
        .ol-overviewmap.ol-uncollapsible button {
            display: none;
        }

        .ol-overviewmap:not(.ol-collapsed) {
            background: var(--ol-subtle-background-color);
        }

        .ol-overviewmap-box {
            border: 1.5px dotted var(--ol-subtle-foreground-color);
        }

        .ol-overviewmap .ol-overviewmap-box:hover {
            cursor: move;
        }
    </style>

    <style>
        html,
        body,
        .map {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        #info {
            position: absolute;
            font-size: 0.7em;
            top: 10px;
            right: 10px;
            background-color: lightgrey;
            padding: 4px;
        }

        #menu {
            all: unset;
            position: absolute;
            font-size: 0.7em;
            top: 10px;
            right: 10px;
            padding: 4px;
            font-size: 30px;
            cursor: pointer;
        }

        .geolocate-buttons {
            position: absolute;
            bottom: 40px;
            left: 10px;
        }
    </style>

    <script>
        !function (n) { "function" == typeof define && define.amd ? define(n) : n() }(function () { if ("undefined" != typeof window && !window.navigator.wakeLock) { var n = !1; window.navigator.wakeLock = { isPolyfill: !0, request: function () { return new Promise(function (e) { if (n) return e(); var t = document.createElement("script"); t.onload = function () { n = !0, e() }, t.crossOrigin = "anonymous", t.src = "https://unpkg.com/nosleep.js@0.10.0", document.head.appendChild(t) }).then(function () { return new Promise(function (n) { var e = new window.NoSleep, t = [], i = { release: function () { e.disable(), t.forEach(function (n) { return n() }) }, addEventListener: function (n, e) { t.push(e) }, removeEventListener: function (n, e) { t = t.filter(function (n) { return n !== e }) } }; document.addEventListener("click", function t() { document.removeEventListener("click", t, !1), e.enable(), n(i) }, !1) }) }) } } } });
    </script>
    <script>(() => { function e(e, n) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); n && (o = o.filter((function (n) { return Object.getOwnPropertyDescriptor(e, n).enumerable }))), t.push.apply(t, o) } return t } function n(n) { for (var o = 1; o < arguments.length; o++) { var a = null != arguments[o] ? arguments[o] : {}; o % 2 ? e(Object(a), !0).forEach((function (e) { t(n, e, a[e]) })) : Object.getOwnPropertyDescriptors ? Object.defineProperties(n, Object.getOwnPropertyDescriptors(a)) : e(Object(a)).forEach((function (e) { Object.defineProperty(n, e, Object.getOwnPropertyDescriptor(a, e)) })) } return n } function t(e, n, t) { return n in e ? Object.defineProperty(e, n, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[n] = t, e } navigator.share = navigator.share || function () { var e = { default: { sms: "SMS", messenger: "Messenger", whatsapp: "WhatsApp", twitter: "Twitter", linkedin: "Linkedin", telegram: "Telegram", facebook: "Facebook", skype: "Skype", pinterest: "Pinterest" }, cs: { shareTitle: "Sdílet", cancel: "Zrušit", copy: "Kopírovat", print: "Tisk", email: "E-mail", selectSms: "Vyberte kontakt" }, sk: { shareTitle: "Zdieľať", cancel: "Zrušiť", copy: "Kopírovat", print: "Tlač", email: "E-mail", selectSms: "Vyberte kontakt" }, ja: { shareTitle: "共有する", cancel: "キャンセル", copy: "コピーする", print: "印刷する", email: "E-mail", selectSms: "連絡先を選択してください" }, zh: { shareTitle: "分享", cancel: "取消", copy: "複製連結", print: "列印", email: "E-mail", selectSms: "選擇聯絡人" }, pt: { shareTitle: "Compartilhar", cancel: "Cancelar", copy: "Copiar", print: "Imprimir", email: "E-mail", selectSms: "Selecione um contato" }, en: { shareTitle: "Share", cancel: "Cancel", copy: "Copy", print: "Print", email: "E-mail", selectSms: "Pick a contact" }, es: { shareTitle: "Compartir", cancel: "Cancelar", copy: "Copiar", print: "Imprimir", email: "Correo", selectSms: "Seleccionar un contacto" }, fr: { shareTitle: "Partager", cancel: "Annuler", copy: "Copier", print: "Imprimer", email: "E-mail", selectSms: "Veuillez choisir un contact" }, de: { shareTitle: "Teilen", cancel: "Abbrechen", copy: "Kopieren", print: "Drucken", email: "E-mail", selectSms: "Wählen Sie einen Kontakt aus" }, it: { shareTitle: "Condividi", cancel: "Annulla", copy: "Copia", print: "Stampa", email: "Email", selectSms: "Seleziona un contatto" }, nl: { shareTitle: "Delen", cancel: "Annuleren", copy: "Kopiëren", print: "Printen", email: "E-mail", selectSms: "Selecteer een contact" }, sv: { shareTitle: "Dela", cancel: "Avbryt", copy: "Kopiera", print: "Skriv ut", email: "E-mail", selectSms: "Välj en kontakt" }, da: { shareTitle: "Del", cancel: "Luk", copy: "Kopiér", print: "Udskriv", email: "E-mail", selectSms: "Vælg en kontaktperson" }, dk: { shareTitle: "Del", cancel: "Luk", copy: "Kopiér", print: "Udskriv", email: "E-mail", selectSms: "Vælg en kontaktperson" }, ru: { shareTitle: "Поделиться", cancel: "Отмена", copy: "Скопировать", print: "Печать", email: "Э-майл", selectSms: "Выбери контакт" }, tr: { shareTitle: "Paylaş", cancel: "Vazgeç", copy: "Kopyala", print: "Yazdır", email: "E-posta", selectSms: "Bir kişi seç" }, ko: { shareTitle: "공유", cancel: "취소", copy: "링크 복사", print: "인쇄", email: "E-mail", selectSms: "연락처를 선택하세요" }, ta: { shareTitle: "பகிர்", cancel: "இரத்து", copy: "நகலெடு", print: "அச்சிடு", email: "மின்னஞ்சல்", selectSms: "ஒரு தொடர்பைத் தேர்வுசெய்க" }, pl: { shareTitle: "Dzielić", cancel: "Anuluj", copy: "Kopiuj", print: "Wydrukować", email: "E-mail", selectSms: "Wybierz kontakt" }, is: { shareTitle: "Deila", cancel: "Hætta við", copy: "Afrita", print: "Prenta", email: "Póstur", selectSms: "Veldu tengilið" }, hu: { shareTitle: "Megosztás", cancel: "Bezárás", copy: "Másolás", print: "Nyomtatás", email: "E-mail", selectSms: "Válasszon egy kontaktot" } }, t = navigator.userAgent.match(/Android/i), o = navigator.userAgent.match(/iPhone|iPad|iPod/i), a = navigator.userAgent.match(/iPhone|iPad|iPod|Macintosh/i), i = !(o || t), c = { share: a ? '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><g><path fill="#424242" d="M381.9,181l95.8-95.8v525.9c0,13.4,8.9,22.3,22.3,22.3c13.4,0,22.3-8.9,22.3-22.3V85.2l95.8,95.8c4.5,4.5,8.9,6.7,15.6,6.7c6.7,0,11.1-2.2,15.6-6.7c8.9-8.9,8.9-22.3,0-31.2L515.6,16.1c-2.2-2.2-4.5-4.5-6.7-4.5c-4.5-2.2-11.1-2.2-17.8,0c-2.2,2.2-4.5,2.2-6.7,4.5L350.7,149.8c-8.9,8.9-8.9,22.3,0,31.2C359.6,190,373,190,381.9,181z M812,276.9H633.7v44.6H812v624H188v-624h178.3v-44.6H188c-24.5,0-44.6,20.1-44.6,44.6v624c0,24.5,20.1,44.6,44.6,44.6h624c24.5,0,44.6-20.1,44.6-44.6v-624C856.6,296.9,836.5,276.9,812,276.9z"/></g></svg>' : '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path fill="#424242" d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/></svg>', email: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path fill="#424242" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"/></svg>', copy: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#424242" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"></path></svg>', print: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#424242" d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"/><path d="M0 0h24v24H0z" fill="none"/></svg>', sms: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#424242" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>', messenger: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#0084ff" d="M224 32C15.9 32-77.5 278 84.6 400.6V480l75.7-42c142.2 39.8 285.4-59.9 285.4-198.7C445.8 124.8 346.5 32 224 32zm23.4 278.1L190 250.5 79.6 311.6l121.1-128.5 57.4 59.6 110.4-61.1-121.1 128.5z"></path></svg>', facebook: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#3b5998" d="M448 56.7v398.5c0 13.7-11.1 24.7-24.7 24.7H309.1V306.5h58.2l8.7-67.6h-67v-43.2c0-19.6 5.4-32.9 33.5-32.9h35.8v-60.5c-6.2-.8-27.4-2.7-52.2-2.7-51.6 0-87 31.5-87 89.4v49.9h-58.4v67.6h58.4V480H24.7C11.1 480 0 468.9 0 455.3V56.7C0 43.1 11.1 32 24.7 32h398.5c13.7 0 24.8 11.1 24.8 24.7z"></path></svg>', whatsapp: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#075e54" d="M224 122.8c-72.7 0-131.8 59.1-131.9 131.8 0 24.9 7 49.2 20.2 70.1l3.1 5-13.3 48.6 49.9-13.1 4.8 2.9c20.2 12 43.4 18.4 67.1 18.4h.1c72.6 0 133.3-59.1 133.3-131.8 0-35.2-15.2-68.3-40.1-93.2-25-25-58-38.7-93.2-38.7zm77.5 188.4c-3.3 9.3-19.1 17.7-26.7 18.8-12.6 1.9-22.4.9-47.5-9.9-39.7-17.2-65.7-57.2-67.7-59.8-2-2.6-16.2-21.5-16.2-41s10.2-29.1 13.9-33.1c3.6-4 7.9-5 10.6-5 2.6 0 5.3 0 7.6.1 2.4.1 5.7-.9 8.9 6.8 3.3 7.9 11.2 27.4 12.2 29.4s1.7 4.3.3 6.9c-7.6 15.2-15.7 14.6-11.6 21.6 15.3 26.3 30.6 35.4 53.9 47.1 4 2 6.3 1.7 8.6-1 2.3-2.6 9.9-11.6 12.5-15.5 2.6-4 5.3-3.3 8.9-2 3.6 1.3 23.1 10.9 27.1 12.9s6.6 3 7.6 4.6c.9 1.9.9 9.9-2.4 19.1zM400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM223.9 413.2c-26.6 0-52.7-6.7-75.8-19.3L64 416l22.5-82.2c-13.9-24-21.2-51.3-21.2-79.3C65.4 167.1 136.5 96 223.9 96c42.4 0 82.2 16.5 112.2 46.5 29.9 30 47.9 69.8 47.9 112.2 0 87.4-72.7 158.5-160.1 158.5z"></path></svg>', twitter: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#1da1f2" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>', linkedin: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#0077b5" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>', telegram: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="#0088cc" d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg>', skype: '<svg class="the-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="#00aff0" d="M424.7 299.8c2.9-14 4.7-28.9 4.7-43.8 0-113.5-91.9-205.3-205.3-205.3-14.9 0-29.7 1.7-43.8 4.7C161.3 40.7 137.7 32 112 32 50.2 32 0 82.2 0 144c0 25.7 8.7 49.3 23.3 68.2-2.9 14-4.7 28.9-4.7 43.8 0 113.5 91.9 205.3 205.3 205.3 14.9 0 29.7-1.7 43.8-4.7 19 14.6 42.6 23.3 68.2 23.3 61.8 0 112-50.2 112-112 .1-25.6-8.6-49.2-23.2-68.1zm-194.6 91.5c-65.6 0-120.5-29.2-120.5-65 0-16 9-30.6 29.5-30.6 31.2 0 34.1 44.9 88.1 44.9 25.7 0 42.3-11.4 42.3-26.3 0-18.7-16-21.6-42-28-62.5-15.4-117.8-22-117.8-87.2 0-59.2 58.6-81.1 109.1-81.1 55.1 0 110.8 21.9 110.8 55.4 0 16.9-11.4 31.8-30.3 31.8-28.3 0-29.2-33.5-75-33.5-25.7 0-42 7-42 22.5 0 19.8 20.8 21.8 69.1 33 41.4 9.3 90.7 26.8 90.7 77.6 0 59.1-57.1 86.5-112 86.5z"></path></svg>', pinterest: '<svg class="the-icon" width="256px" height="256px" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid"><path d="M0,128.002 C0,180.416 31.518,225.444 76.619,245.241 C76.259,236.303 76.555,225.573 78.847,215.848 C81.308,205.457 95.317,146.1 95.317,146.1 C95.317,146.1 91.228,137.927 91.228,125.848 C91.228,106.879 102.222,92.712 115.914,92.712 C127.557,92.712 133.182,101.457 133.182,111.929 C133.182,123.633 125.717,141.14 121.878,157.355 C118.671,170.933 128.686,182.008 142.081,182.008 C166.333,182.008 182.667,150.859 182.667,113.953 C182.667,85.899 163.772,64.901 129.405,64.901 C90.577,64.901 66.388,93.857 66.388,126.201 C66.388,137.353 69.676,145.217 74.826,151.307 C77.194,154.104 77.523,155.229 76.666,158.441 C76.052,160.796 74.642,166.466 74.058,168.713 C73.206,171.955 70.579,173.114 67.649,171.917 C49.765,164.616 41.436,145.031 41.436,123.015 C41.436,86.654 72.102,43.054 132.918,43.054 C181.788,43.054 213.953,78.418 213.953,116.379 C213.953,166.592 186.037,204.105 144.887,204.105 C131.068,204.105 118.069,196.635 113.616,188.15 C113.616,188.15 106.185,217.642 104.611,223.337 C101.897,233.206 96.585,243.07 91.728,250.758 C103.24,254.156 115.401,256.007 128.005,256.007 C198.689,256.007 256.001,198.698 256.001,128.002 C256.001,57.309 198.689,0 128.005,0 C57.314,0 0,57.309 0,128.002 Z" fill="#CB1F27"></path></svg>' }; function l(e) { var n = e, t = document.head || document.getElementsByTagName("head")[0], o = document.createElement("style"); o.type = "text/css", o.appendChild(document.createTextNode(n)), o.id = "shareAPIPolyfill-style", t.appendChild(o) } return function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, o = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return new Promise((function (s, r) { t.title && "string" == typeof t.title && t.text && "string" == typeof t.text || r("Invalid Params"); var p = t.title, d = t.url, h = t.fbId, m = t.hashtags, g = t.via, v = t.hashtag, y = n(n({}, { copy: !0, print: !0, email: !0, sms: !0, messenger: !0, facebook: !0, whatsapp: !0, twitter: !0, linkedin: !0, telegram: !0, skype: !0, pinterest: !0, language: "en" }), o), w = n(n({}, e.default), e[y.language] ? e[y.language] : e[navigator.language] || e[navigator.language.substr(0, 2).toLowerCase()] || e.en), u = t.text || p, f = encodeURIComponent(t.image); function b() { k.classList.remove("visible"), P.classList.remove("visible"), k.addEventListener("transitionend", (function e() { k.removeEventListener("transitionend", e), document.body.removeChild(k) })), P.addEventListener("transitionend", (function e() { P.removeEventListener("transitionend", e), document.body.removeChild(P), document.head.removeChild(document.querySelector("#shareAPIPolyfill-style")), document.removeEventListener("keyup", x) })) } l('\n#shareAPIPolyfill-backdrop,\n#shareAPIPolyfill-container {\n  opacity: 0;\n  pointer-events: none;\n  position: fixed;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  width: 100%;\n  height: 100%;\n  will-change: opacity;\n  z-index: 99999999;\n}\n#shareAPIPolyfill-backdrop {\n  transition: opacity linear 250ms;\n  background-color: rgba(0, 0, 0, 0.6);\n}\n#shareAPIPolyfill-container {\n  color: #424242;\n  background-color: #f9f9f9;\n  top: auto;\n  max-width: 400px;\n  height: auto;\n  transition-property: transform,opacity;\n  transition-timing-function: linear;\n  transition-duration: 250ms;\n  transition-delay: 150ms;\n  transform: translateY(100%);\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", arial, sans-serif, "Microsoft JhengHei";\n}\n#shareAPIPolyfill-backdrop.visible,\n#shareAPIPolyfill-container.visible {\n  opacity: 1;\n  pointer-events: all;\n}\n#shareAPIPolyfill-container.visible {\n  transform: translateY(0);\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-header {\n  background: #EEE;\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-header .shareAPIPolyfill-icons-container {\n  display: flex;\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-header-title {\n  background-color: #E0E0E0;\n  padding: 10px 18px;\n  color: #424242;\n  font-weight: 600;\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-body {\n  border-top: solid 1px #EEE;\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-footer {\n width: 100%;\n display: block;\n border: none;\n transition: opacity ease-in 250ms;\n border-top: solid 1px #EEE;\n background-color: #EEE;\n text-align: center;\n padding: 10px;\n font-size:13px;\n cursor: pointer;\n opacity: .5;\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-footer:hover {\n  opacity: 1;\n}\n#shareAPIPolyfill-container .shareAPIPolyfill-icons-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n#shareAPIPolyfill-container .tool-icon {\n border: none;\n display: inline-block;\n width: 25%;\n box-sizing: border-box;\n font-weight: 400;\n font-size: 12px;\n -webkit-font-smoothing: antialiased;\n -moz-osx-font-smoothing: grayscale;\n text-align: center;\n cursor: pointer;\n background-color: transparent;\n padding: 20px 0;\n}\n#shareAPIPolyfill-container .tool-icon:hover {\n  box-shadow: inset 0 0 20px rgba(0,0,0, .125);\n}\n#shareAPIPolyfill-container .the-icon-title {\n padding-top: 10px;\n display: block;\n}\n.shareAPIPolyfill-header-title .the-icon {\n\tdisplay: inline-block;\n\theight: 20px;\n\twidth: 20px;\n\tpadding-right: 5px;\n\tvertical-align:'.concat(a ? "-2px" : "-4px", ";\n}\n.shareAPIPolyfill-icons-container.title .tool-icon .the-icon,\n.shareAPIPolyfill-icons-container.body .tool-icon .the-icon {\n  display: block;\n  margin: auto;\n  width: 42px;\n  height: 36px;\n}\n.shareAPIPolyfill-icons-container.title .tool-icon .the-icon {\n  height: 24px;\n}\n.shareAPIPolyfill-icons-container .hidden {\n  display: none !important;\n}\n")); var k = document.createElement("div"), P = document.createElement("div"); function x(e) { 27 === e.keyCode && b() } k.id = "shareAPIPolyfill-backdrop", P.id = "shareAPIPolyfill-container", P.setAttribute("tabindex", "0"), P.innerHTML = '\n<div class="shareAPIPolyfill-header">\n <div class="shareAPIPolyfill-header-title" tabindex="0">'.concat(c.share, " ").concat(w.shareTitle, '</div>\n <div class="shareAPIPolyfill-icons-container title">\n  <button class="').concat(y.copy ? "" : "hidden", ' tool-icon copy" data-tool="copy">\n   ').concat(c.copy, '\n   <span class="the-icon-title">').concat(w.copy, '</span>\n  </button>\n  <button class="').concat(y.print ? "" : "hidden", ' tool-icon print" data-tool="print">\n   ').concat(c.print, '\n   <span class="the-icon-title">').concat(w.print, '</span>\n  </button>\n  <button class="').concat(y.email ? "" : "hidden", ' tool-icon email" data-tool="email">\n   ').concat(c.email, '\n   <span class="the-icon-title">').concat(w.email, '</span>\n  </button>\n  <button class="').concat(y.sms ? "" : "hidden", ' tool-icon sms" data-tool="sms">\n   ').concat(c.sms, '\n   <span class="the-icon-title">').concat(w.sms, '</span>\n  </button>\n </div>\n</div>\n<div class="shareAPIPolyfill-body">\n <div class="shareAPIPolyfill-icons-container body">\n  ').concat(h ? '\n   <button class="tool-icon messenger '.concat(y.messenger ? "" : "hidden", '" data-tool="messenger">\n    ').concat(c.messenger, '\n    <span class="the-icon-title">').concat(w.messenger, "</span>\n   </button>\n  ") : "", '\n  <button class="').concat(y.facebook ? "" : "hidden", ' tool-icon facebook" data-tool="facebook">\n   ').concat(c.facebook, '\n   <span class="the-icon-title">').concat(w.facebook, '</span>\n  </button>\n  <button class="').concat(y.whatsapp ? "" : "hidden", ' tool-icon whatsapp" data-tool="whatsapp">\n   ').concat(c.whatsapp, '\n   <span class="the-icon-title">').concat(w.whatsapp, '</span>\n  </button>\n  <button class="').concat(y.twitter ? "" : "hidden", ' tool-icon twitter" data-tool="twitter">\n   ').concat(c.twitter, '\n   <span class="the-icon-title">').concat(w.twitter, '</span>\n  </button>\n  <button class="').concat(y.linkedin ? "" : "hidden", ' tool-icon linkedin" data-tool="linkedin">\n   ').concat(c.linkedin, '\n   <span class="the-icon-title">').concat(w.linkedin, '</span>\n  </button>\n  <button class="').concat(y.telegram ? "" : "hidden", ' tool-icon telegram" data-tool="telegram">\n   ').concat(c.telegram, '\n   <span class="the-icon-title">').concat(w.telegram, '</span>\n  </button>\n  <button class="').concat(y.skype ? "" : "hidden", ' tool-icon skype skype-share" data-tool="skype" data-href="').concat(d, '" data-text="').concat(p + ": " + d, '">\n   ').concat(c.skype, '\n   <span class="the-icon-title">').concat(w.skype, '</span>\n  </button>\n  <button class="').concat(y.pinterest ? "" : "hidden", ' tool-icon pinterest" data-tool="pinterest">\n   ').concat(c.pinterest, '\n   <span class="the-icon-title">').concat(w.pinterest, '</span>\n  </button>\n </div>\n <button class="shareAPIPolyfill-footer">\n  ').concat(w.cancel, "\n </button>\n</div>\n"), k.addEventListener("click", (function () { b() })), !1 !== y.skype && function (e, n, t) { e.loadSkypeWebSdkAsync = e.loadSkypeWebSdkAsync || function (e) { var o, a = n.getElementsByTagName(t)[0]; n.getElementById(e.id) || ((o = n.createElement(t)).id = e.id, o.src = e.scriptToLoad, o.onload = e.callback, a.parentNode.insertBefore(o, a)) }; e.loadSkypeWebSdkAsync({ scriptToLoad: "https://swx.cdn.skype.com/shared/v/latest/skypewebsdk.js", id: "skype_web_sdk" }) }(window, document, "script"), requestAnimationFrame((function (e) { document.body.appendChild(k), document.body.appendChild(P), document.addEventListener("keyup", x), Array.from(P.querySelectorAll(".tool-icon")).forEach((function (e) { e.addEventListener("click", (function (n) { var o = encodeURIComponent(u + ": " + d); switch (e.dataset.tool) { case "copy": navigator.clipboard.writeText("".concat(p, "\n").concat(t.text || "", "\n").concat(d)); break; case "print": setTimeout((function (e) { self.print() }), 500); break; case "email": var a = "".concat(encodeURIComponent(u), "%0D%0A"), c = "mailto:?subject=".concat(p, "&body=").concat(a).concat(encodeURIComponent(d)); window.open(c); break; case "sms": location.href = "sms:".concat(w.selectSms, "?&body=").concat(encodeURIComponent(p), ": ").concat(encodeURIComponent(t.text || ""), " ").concat(d); break; case "messenger": window.open("http://www.facebook.com/dialog/send?app_id=" + h + "&display=popup&href=" + encodeURIComponent(d) + "&link=" + encodeURIComponent(d) + "&redirect_uri=" + encodeURIComponent(d) + "&quote=" + encodeURIComponent(u)); break; case "facebook": window.open("https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(d) + "&quote=" + encodeURIComponent(u) + "&hashtag=" + (v || m || "")); break; case "whatsapp": window.open((i ? "https://api.whatsapp.com/send?text=" : "whatsapp://send?text=") + encodeURIComponent(u + "\n" + d)); break; case "twitter": window.open("https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(u), "&url=").concat(encodeURIComponent(d), "&hashtags=").concat(m || "", "&via=").concat(g ? encodeURIComponent(g) : "")); break; case "linkedin": window.open("https://www.linkedin.com/shareArticle?mini=true&url=".concat(encodeURIComponent(d), "&title=").concat(p, "&summary=").concat(u, "&source=LinkedIn")); break; case "telegram": window.open(i ? "https://telegram.me/share/msg?url=" + encodeURIComponent(d) + "&text=" + encodeURIComponent(u) : "tg://msg?text=" + o); break; case "pinterest": window.open("https://pinterest.com/pin/create/button/?url=" + encodeURIComponent(d) + "&description=" + encodeURIComponent(u) + "&media=" + f) }s(), b() })) })), P.querySelector(".shareAPIPolyfill-footer").addEventListener("click", b), requestAnimationFrame((function () { k.classList.add("visible"), P.classList.add("visible") })), document.getElementById("shareAPIPolyfill-container").focus() })) })) } }() })();</script>
    <style>
        dialog::backdrop {
            background: repeating-linear-gradient(45deg,
                    rgba(0, 0, 0, 0.2),
                    rgba(0, 0, 0, 0.2) 1px,
                    rgba(0, 0, 0, 0.3) 1px,
                    rgba(0, 0, 0, 0.3) 20px);
            backdrop-filter: blur(3px);
        }

        dialog {
            width: 100vw;
            height: 100vh;
        }

        dialog form button {
            all: unset;
        }


        :modal {
            display: grid;
            justify-content: center;
        }

        dialog {
            height: 100%;
            width: 100%;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            /* background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.9); */
        }

        .overlay-content {
            position: relative;
            width: fit-content;
            text-align: center;
            margin-top: 30px;
            display: inline-grid;
            align-content: center;
        }

        .overlay-content button {
            all: unset;
            cursor: pointer;
        }

        .overlay-content button:focus-visible {
            outline-color: rgb(129, 129, 129);
            outline-offset: 0px;
            outline-style: auto;
            outline-width: 1px
        }

        .overlay button,
        .overlay-content a,
        .overlay-content button {
            padding: 8px;
            text-decoration: none;
            font-size: 36px;
            color: #818181;
            display: block;
            transition: 0.3s;
        }

        .overlay .closebtn {
            position: absolute;
            top: 20px;
            right: 45px;
            font-size: 60px;
        }

        @media screen and (max-height: 450px) {
            .overlay a {
                font-size: 20px
            }

            .overlay .closebtn {
                font-size: 40px;
                top: 15px;
                right: 35px;
            }
        }
    </style>
</head>

<body>
    <dialog id="dialog" class="overlay">
        <div class="overlay-content">
            <button id="share_location">Share My Location</a>
                <button id="share_link">Share Link</button>
                <hr>
                <a href="/">New Session</a>
        </div>
        <form method="dialog"><button class="closebtn">&times;</button></form>
    </dialog>
    <div id="map" class="map"></div>
    <button id="menu" onclick="window.dialog.showModal();">&#9776; open</button>
    <!-- <div id="info"></div> -->
    <img id="geolocation_marker" src="/geolocation_marker.png" />
    <!-- <div class="geolocate-buttons">
        <button id="geolocate" class="btn btn-primary">Geolocate Me!</button>
        <button id="simulate" class="btn btn-secondary">Simulate</button>
    </div> -->
    <script type="module">
        import { Geolocation, Map, Overlay, View } from 'https://esm.sh/ol@8.2.0?bundle-deps'
        import LineString from 'https://esm.sh/ol@8.2.0/geom/LineString.js?bundle-deps';
        import OSM from 'https://esm.sh/ol@8.2.0/source/OSM.js?bundle-deps';
        import TileLayer from 'https://esm.sh/ol@8.2.0/layer/Tile.js?bundle-deps';
        import { fromLonLat } from 'https://esm.sh/ol@8.2.0/proj.js?bundle-deps';

        const simulationData = [{
            "coords": {
                "speed": 1.7330950498580933,
                "accuracy": 5,
                "altitudeAccuracy": 8,
                "altitude": 238,
                "longitude": 5.868668798362713,
                "heading": 67.5,
                "latitude": 45.64444874417562
            },
            "timestamp": 1394788264972
        }, {
            "coords": {
                "speed": 1.9535436630249023,
                "accuracy": 5,
                "altitudeAccuracy": 8,
                "altitude": 238,
                "longitude": 5.868715401744348,
                "heading": 69.609375,
                "latitude": 45.64446391542036
            },
            "timestamp": 1394788266115
        }, {
            "coords": {
                "speed": 2.1882569789886475,
                "accuracy": 10,
                "altitudeAccuracy": 8,
                "altitude": 238,
                "longitude": 5.868768962105614,
                "heading": 67.5,
                "latitude": 45.644484995906836
            },
            "timestamp": 1394788267107
        }, {
            "coords": {
                "speed": 2.4942498207092285,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 237,
                "longitude": 5.868825791409117,
                "heading": 68.5546875,
                "latitude": 45.64450435810316
            },
            "timestamp": 1394788267959
        }, {
            "coords": {
                "speed": 2.7581217288970947,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 237,
                "longitude": 5.868881698703271,
                "heading": 69.609375,
                "latitude": 45.64452149909515
            },
            "timestamp": 1394788268964
        }, {
            "coords": {
                "speed": 3.3746347427368164,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 236,
                "longitude": 5.868938528006774,
                "heading": 70.3125,
                "latitude": 45.644536712249405
            },
            "timestamp": 1394788270116
        }, {
            "coords": {
                "speed": 3.597411870956421,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 236,
                "longitude": 5.868992004549009,
                "heading": 74.8828125,
                "latitude": 45.644547943999655
            },
            "timestamp": 1394788271158
        }, {
            "coords": {
                "speed": 3.6382505893707275,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 236,
                "longitude": 5.869038775568706,
                "heading": 73.828125,
                "latitude": 45.64456005584974
            },
            "timestamp": 1394788271893
        }, {
            "coords": {
                "speed": 3.65671443939209,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 236,
                "longitude": 5.869091162463528,
                "heading": 73.4765625,
                "latitude": 45.644572335337884
            },
            "timestamp": 1394788272903
        }, {
            "coords": {
                "speed": 3.7153592109680176,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 236,
                "longitude": 5.869144219910604,
                "heading": 73.125,
                "latitude": 45.64458671030182
            },
            "timestamp": 1394788273914
        }, {
            "coords": {
                "speed": 3.8041043281555176,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 236,
                "longitude": 5.869205072527629,
                "heading": 72.421875,
                "latitude": 45.64460313883204
            },
            "timestamp": 1394788274901
        }, {
            "coords": {
                "speed": 3.9588162899017334,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 236,
                "longitude": 5.869268858810765,
                "heading": 72.421875,
                "latitude": 45.64461990263838
            },
            "timestamp": 1394788276140
        }, {
            "coords": {
                "speed": 4.152309417724609,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 235,
                "longitude": 5.869351252918941,
                "heading": 78.046875,
                "latitude": 45.64466122542102
            },
            "timestamp": 1394788276948
        }, {
            "coords": {
                "speed": 4.49971866607666,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 236,
                "longitude": 5.869433479389054,
                "heading": 79.8046875,
                "latitude": 45.64467040360499
            },
            "timestamp": 1394788277892
        }, {
            "coords": {
                "speed": 4.824056148529053,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.869504055013758,
                "heading": 91.40625,
                "latitude": 45.64466089014489
            },
            "timestamp": 1394788279211
        }, {
            "coords": {
                "speed": 5.269814491271973,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.869575049733621,
                "heading": 91.40625,
                "latitude": 45.64465967476893
            },
            "timestamp": 1394788279898
        }, {
            "coords": {
                "speed": 5.4861016273498535,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.86963213049422,
                "heading": 95.2734375,
                "latitude": 45.64465091568012
            },
            "timestamp": 1394788280935
        }, {
            "coords": {
                "speed": 5.380503177642822,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.869714859878523,
                "heading": 75.5859375,
                "latitude": 45.64468792178262
            },
            "timestamp": 1394788281930
        }, {
            "coords": {
                "speed": 5.276519775390625,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 234,
                "longitude": 5.869746124377353,
                "heading": 55.1953125,
                "latitude": 45.64467706721801
            },
            "timestamp": 1394788282909
        }, {
            "coords": {
                "speed": 5.212399482727051,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 232,
                "longitude": 5.8697939850444625,
                "heading": 49.5703125,
                "latitude": 45.64467899505574
            },
            "timestamp": 1394788284221
        }, {
            "coords": {
                "speed": 5.174651622772217,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 232,
                "longitude": 5.869789123540623,
                "heading": 18.984375,
                "latitude": 45.64469378911484
            },
            "timestamp": 1394788284924
        }, {
            "coords": {
                "speed": 5.211904525756836,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 232,
                "longitude": 5.869806222623093,
                "heading": 10.1953125,
                "latitude": 45.64473896757294
            },
            "timestamp": 1394788286251
        }, {
            "coords": {
                "speed": 5.254780292510986,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 233,
                "longitude": 5.86982952431391,
                "heading": 18.6328125,
                "latitude": 45.64478381075491
            },
            "timestamp": 1394788286927
        }, {
            "coords": {
                "speed": 5.329030513763428,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 232,
                "longitude": 5.869875792419417,
                "heading": 33.75,
                "latitude": 45.644830078860416
            },
            "timestamp": 1394788288221
        }, {
            "coords": {
                "speed": 5.384955883026123,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 232,
                "longitude": 5.869927508761985,
                "heading": 46.7578125,
                "latitude": 45.64486025371183
            },
            "timestamp": 1394788288935
        }, {
            "coords": {
                "speed": 5.309582233428955,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 232,
                "longitude": 5.869972854858143,
                "heading": 47.109375,
                "latitude": 45.644890596201314
            },
            "timestamp": 1394788290178
        }, {
            "coords": {
                "speed": 5.250724792480469,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.870029265066488,
                "heading": 46.40625,
                "latitude": 45.644932673355235
            },
            "timestamp": 1394788290890
        }, {
            "coords": {
                "speed": 5.3057990074157715,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.870077712466819,
                "heading": 39.375,
                "latitude": 45.644970224281444
            },
            "timestamp": 1394788291884
        }, {
            "coords": {
                "speed": 5.431822299957275,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.870133116846783,
                "heading": 43.59375,
                "latitude": 45.6450097449549
            },
            "timestamp": 1394788292885
        }, {
            "coords": {
                "speed": 5.542125225067139,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.870186509569986,
                "heading": 43.59375,
                "latitude": 45.645047421609654
            },
            "timestamp": 1394788294100
        }, {
            "coords": {
                "speed": 5.647174835205078,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.870246104901535,
                "heading": 42.890625,
                "latitude": 45.645093647805645
            },
            "timestamp": 1394788295157
        }, {
            "coords": {
                "speed": 5.735793590545654,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 230,
                "longitude": 5.870298156520231,
                "heading": 42.5390625,
                "latitude": 45.64514368776758
            },
            "timestamp": 1394788296124
        }, {
            "coords": {
                "speed": 5.809989929199219,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 230,
                "longitude": 5.870346436282499,
                "heading": 43.59375,
                "latitude": 45.64519154843469
            },
            "timestamp": 1394788296960
        }, {
            "coords": {
                "speed": 5.877871036529541,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 228,
                "longitude": 5.87034755932109,
                "heading": 42.75193405151367,
                "latitude": 45.645270362475216
            },
            "timestamp": 1394788298177
        }, {
            "coords": {
                "speed": 5.937166690826416,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 228,
                "longitude": 5.870402806867787,
                "heading": 42.75193405151367,
                "latitude": 45.645312142096095
            },
            "timestamp": 1394788298898
        }, {
            "coords": {
                "speed": 6.071393966674805,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 229,
                "longitude": 5.870464520921814,
                "heading": 43.183074951171875,
                "latitude": 45.64535851937182
            },
            "timestamp": 1394788299897
        }, {
            "coords": {
                "speed": 6.329115390777588,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 230,
                "longitude": 5.8705368384107715,
                "heading": 43.183074951171875,
                "latitude": 45.645412389093565
            },
            "timestamp": 1394788300957
        }, {
            "coords": {
                "speed": 6.581554889678955,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 229,
                "longitude": 5.870600162706978,
                "heading": 43.183074951171875,
                "latitude": 45.64545955929912
            },
            "timestamp": 1394788302211
        }, {
            "coords": {
                "speed": 6.605470180511475,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 230,
                "longitude": 5.870657211053185,
                "heading": 43.183074951171875,
                "latitude": 45.64550205482465
            },
            "timestamp": 1394788302917
        }, {
            "coords": {
                "speed": 6.623170375823975,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 229,
                "longitude": 5.870713613403495,
                "heading": 43.183074951171875,
                "latitude": 45.64554406917767
            },
            "timestamp": 1394788303929
        }, {
            "coords": {
                "speed": 6.645580768585205,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 229,
                "longitude": 5.870773011629353,
                "heading": 43.183074951171875,
                "latitude": 45.64558831489415
            },
            "timestamp": 1394788304902
        }, {
            "coords": {
                "speed": 6.663600444793701,
                "accuracy": 5,
                "altitudeAccuracy": 4,
                "altitude": 229,
                "longitude": 5.87083890910435,
                "heading": 43.183074951171875,
                "latitude": 45.645637401898654
            },
            "timestamp": 1394788306035
        }, {
            "coords": {
                "speed": 6.664675712585449,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 229,
                "longitude": 5.870890033475007,
                "heading": 43.183074951171875,
                "latitude": 45.64567548463474
            },
            "timestamp": 1394788307080
        }, {
            "coords": {
                "speed": 6.6489081382751465,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 228,
                "longitude": 5.870943189474929,
                "heading": 43.183074951171875,
                "latitude": 45.645715080460064
            },
            "timestamp": 1394788308211
        }, {
            "coords": {
                "speed": 6.551820755004883,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 228,
                "longitude": 5.871005613698799,
                "heading": 43.183074951171875,
                "latitude": 45.64576158014743
            },
            "timestamp": 1394788308904
        }, {
            "coords": {
                "speed": 6.467689514160156,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 229,
                "longitude": 5.871058030061249,
                "heading": 43.183074951171875,
                "latitude": 45.64580062501799
            },
            "timestamp": 1394788310161
        }, {
            "coords": {
                "speed": 6.3997955322265625,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 229,
                "longitude": 5.871062579208228,
                "heading": 43.183074951171875,
                "latitude": 45.64580401381376
            },
            "timestamp": 1394788310957
        }, {
            "coords": {
                "speed": 5.799798488616943,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 230,
                "longitude": 5.8710817079554545,
                "heading": 43.183074951171875,
                "latitude": 45.64581826277647
            },
            "timestamp": 1394788312036
        }, {
            "coords": {
                "speed": 4.424941062927246,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 230,
                "longitude": 5.871121835629857,
                "heading": 175.4296875,
                "latitude": 45.645828271551544
            },
            "timestamp": 1394788312951
        }, {
            "coords": {
                "speed": 4.3496222496032715,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.8710026017471595,
                "heading": 176.484375,
                "latitude": 45.645752236602775
            },
            "timestamp": 1394788315227
        }, {
            "coords": {
                "speed": 5.076380252838135,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 232,
                "longitude": 5.871189236646398,
                "heading": 176.1328125,
                "latitude": 45.64553692475487
            },
            "timestamp": 1394788316970
        }, {
            "coords": {
                "speed": 5.102786064147949,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.871200384577616,
                "heading": 171.2109375,
                "latitude": 45.64548554368843
            },
            "timestamp": 1394788317965
        }, {
            "coords": {
                "speed": 4.705626964569092,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.871210945775612,
                "heading": 164.1796875,
                "latitude": 45.645453105723156
            },
            "timestamp": 1394788318956
        }, {
            "coords": {
                "speed": 4.378190040588379,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 231,
                "longitude": 5.87124749087344,
                "heading": 126.2109375,
                "latitude": 45.645433282522156
            },
            "timestamp": 1394788320197
        }, {
            "coords": {
                "speed": 4.208680152893066,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 233,
                "longitude": 5.871283365419014,
                "heading": 125.859375,
                "latitude": 45.6454103999265
            },
            "timestamp": 1394788320894
        }, {
            "coords": {
                "speed": 4.072604179382324,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 233,
                "longitude": 5.871314043184622,
                "heading": 103.359375,
                "latitude": 45.645410819021656
            },
            "timestamp": 1394788322169
        }, {
            "coords": {
                "speed": 3.7680623531341553,
                "accuracy": 5,
                "altitudeAccuracy": 6,
                "altitude": 234,
                "longitude": 5.871355114510163,
                "heading": 92.4609375,
                "latitude": 45.645418111277415
            },
            "timestamp": 1394788322898
        }, {
            "coords": {
                "speed": 3.537794351577759,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 234,
                "longitude": 5.871393922721847,
                "heading": 92.4609375,
                "latitude": 45.64541693781097
            },
            "timestamp": 1394788323968
        }, {
            "coords": {
                "speed": 3.3741507530212402,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 234,
                "longitude": 5.8714455552453835,
                "heading": 75.5859375,
                "latitude": 45.645444011358215
            },
            "timestamp": 1394788324896
        }, {
            "coords": {
                "speed": 3.3729660511016846,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.87150791660498,
                "heading": 70.3125,
                "latitude": 45.64547209073384
            },
            "timestamp": 1394788325971
        }, {
            "coords": {
                "speed": 3.463883876800537,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.871554352348551,
                "heading": 70.3125,
                "latitude": 45.64548374157925
            },
            "timestamp": 1394788327122
        }, {
            "coords": {
                "speed": 3.5247886180877686,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.871567260479435,
                "heading": 67.1484375,
                "latitude": 45.645496733529164
            },
            "timestamp": 1394788328164
        }, {
            "coords": {
                "speed": 3.455146551132202,
                "accuracy": 10,
                "altitudeAccuracy": 6,
                "altitude": 235,
                "longitude": 5.871608583262071,
                "heading": 68.90625,
                "latitude": 45.64550293613751
            },
            "timestamp": 1394788328985
        }, {
            "coords": {
                "speed": 3.382997989654541,
                "accuracy": 10,
                "altitudeAccuracy": 8,
                "altitude": 236,
                "longitude": 5.871640518313154,
                "heading": 78.75,
                "latitude": 45.6454965658911
            },
            "timestamp": 1394788329900
        }, {
            "coords": {
                "speed": 3.242330312728882,
                "accuracy": 10,
                "altitudeAccuracy": 8,
                "altitude": 236,
                "longitude": 5.871667759498462,
                "heading": 92.4609375,
                "latitude": 45.64548562750746
            },
            "timestamp": 1394788331120
        }, {
            "coords": {
                "speed": 3.074465274810791,
                "accuracy": 10,
                "altitudeAccuracy": 8,
                "altitude": 236,
                "longitude": 5.871691312646374,
                "heading": 110.0390625,
                "latitude": 45.645468402696444
            },
            "timestamp": 1394788332219
        }]


        let evtSource;
        let url = new URL(window.location)
        let searchParams = new URLSearchParams(url.hash.slice(1))
        let channel = searchParams.get('channel')
        let key = searchParams.get('key')
        let newChannel = false;
        if (key) {
            key = await window.crypto.subtle.importKey(
                "jwk",
                {
                    k: key,
                    alg: "A128GCM",
                    ext: true,
                    key_ops: ["encrypt", "decrypt"],
                    kty: "oct",
                },
                { name: "AES-GCM", length: 128 },
                true, // extractable
                ["decrypt", "encrypt"],
            );
        }
        if (!channel || !key) {
            newChannel = true;
            channel = crypto.randomUUID()
            searchParams.set('channel', channel)
            key = await window.crypto.subtle.generateKey(
                { name: "AES-GCM", length: 128 },
                true, // extractable
                ["encrypt", "decrypt"],
            );
            const objectKey = (await window.crypto.subtle.exportKey("jwk", key)).k;
            searchParams.set('key', objectKey)

            url.hash = searchParams.toString()

            history.pushState({}, "", url);
        }

        // creating the view
        const view = new View({
            center: fromLonLat([5.8713, 45.6452]),
            zoom: 19,
        });

        const tileLayer = new TileLayer({
            source: new OSM(),
        });

        // creating the map
        const map = new Map({
            layers: [tileLayer],
            target: 'map',
            view: view,
        });

        // Geolocation marker
        const markerEl = document.getElementById('geolocation_marker');
        const marker = new Overlay({
            positioning: 'center-center',
            element: markerEl,
            stopEvent: false,
        });
        map.addOverlay(marker);

        // LineString to store the different geolocation positions. This LineString
        // is time aware.
        // The Z dimension is actually used to store the rotation (heading).
        const positions = new LineString([], 'XYZM');

        // Geolocation Control
        const geolocation = new Geolocation({
            projection: view.getProjection(),
            trackingOptions: {
                maximumAge: 10000,
                enableHighAccuracy: true,
                timeout: 600000,
            },
        });

        let deltaMean = 500; // the geolocation sampling period mean in ms

        // Listen to position changes
        geolocation.on('change', async function () {
            const position = geolocation.getPosition();
            const accuracy = geolocation.getAccuracy();
            const heading = geolocation.getHeading() || 0;
            const speed = geolocation.getSpeed() || 0;
            const m = Date.now();

            const coords = positions.getCoordinates();
            const len = coords.length;
            if (len >= 2) {
                deltaMean = (coords[len - 1][3] - coords[0][3]) / (len - 1);
            }

            const data = {
                position,
                accuracy,
                heading,
                speed,
                m,
                deltaMean
            }

            const iv = new Uint8Array(12);
            crypto.getRandomValues(iv);

            const encrypted = new Uint8Array(await window.crypto.subtle.encrypt(
                { name: "AES-GCM", iv },
                key,
                new TextEncoder().encode(JSON.stringify(data)),
            ));

            fetch(`/update`, {
                method: 'POST',
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    channel,
                    encrypted,
                    iv
                })
            })
        });

        geolocation.on('error', function () {
            // TODO we should remove the coordinates in positions
        });

        // convert radians to degrees
        function radToDeg(rad) {
            return (rad * 360) / (Math.PI * 2);
        }
        // convert degrees to radians
        function degToRad(deg) {
            return (deg * Math.PI * 2) / 360;
        }
        // modulo for negative values
        function mod(n) {
            return ((n % (2 * Math.PI)) + 2 * Math.PI) % (2 * Math.PI);
        }

        function addPosition(position, heading, m, speed) {
            const x = position[0];
            const y = position[1];
            const fCoords = positions.getCoordinates();
            const previous = fCoords[fCoords.length - 1];
            const prevHeading = previous && previous[2];
            if (prevHeading) {
                let headingDiff = heading - mod(prevHeading);

                // force the rotation change to be less than 180°
                if (Math.abs(headingDiff) > Math.PI) {
                    const sign = headingDiff >= 0 ? 1 : -1;
                    headingDiff = -sign * (2 * Math.PI - Math.abs(headingDiff));
                }
                heading = prevHeading + headingDiff;
            }
            positions.appendCoordinate([x, y, heading, m]);

            // only keep the 20 last coordinates
            positions.setCoordinates(positions.getCoordinates().slice(-20));

            if (heading && speed) {
                markerEl.src = '/geolocation_marker_heading.png';
            } else {
                markerEl.src = '/geolocation_marker.png';
            }
        }

        // recenters the view by putting the given coordinates at 3/4 from the top or
        // the screen
        function getCenterWithHeading(position, rotation, resolution) {
            const size = map.getSize();
            const height = size[1];

            return [
                position[0] - (Math.sin(rotation) * height * resolution * 1) / 4,
                position[1] + (Math.cos(rotation) * height * resolution * 1) / 4,
            ];
        }

        let previousM = 0;
        function updateView() {
            // use sampling period to get a smooth transition
            let m = Date.now() - deltaMean * 1.5;
            m = Math.max(m, previousM);
            previousM = m;
            // interpolate position along positions LineString
            const c = positions.getCoordinateAtM(m, true);
            if (c) {
                view.setCenter(getCenterWithHeading(c, -c[2], view.getResolution()));
                view.setRotation(-c[2]);
                marker.setPosition(c);
                map.render();
            }
        }

        // geolocate device
        function go() {
            geolocation.setTracking(true); // Start position tracking
            updateView()

            tileLayer.on('postrender', updateView);
            map.render();

            disableButtons();
        }

        // simulate device move
        function simulate() {
            const coordinates = simulationData;

            const first = coordinates.shift();
            simulatePositionChange(first);

            let prevDate = first.timestamp;
            function geolocate() {
                const position = coordinates.shift();
                if (!position) {
                    return;
                }
                const newDate = position.timestamp;
                simulatePositionChange(position);
                window.setTimeout(
                    function () {
                        prevDate = newDate;
                        geolocate();
                    },
                    (newDate - prevDate) / 0.5,
                );
            }
            geolocate();

            tileLayer.on('postrender', updateView);
            map.render();

            disableButtons();
        }

        function simulatePositionChange(position) {
            const coords = position.coords;
            geolocation.set('accuracy', coords.accuracy);
            geolocation.set('heading', degToRad(coords.heading));
            const projectedPosition = fromLonLat([coords.longitude, coords.latitude]);
            geolocation.set('position', projectedPosition);
            geolocation.set('speed', coords.speed);
            geolocation.changed();
        }

        function disableButtons() {
            // geolocateBtn.disabled = 'disabled';
            // simulateBtn.disabled = 'disabled';
        }

        const source = `/stream/sse?channel=${channel}`

        function setupEventSource() {
            evtSource = new EventSource(source);
            evtSource.addEventListener("open", async event => {
                if (newChannel) {
                    // simulate()
                    go()

                    // TODO: Make this a button/toggle in the menu instead of always on
                    try {
                        const wakeLock = await navigator.wakeLock.request("screen");
                    } catch (err) {
                        // the wake lock request fails - usually system related, such being low on battery
                        console.log(`${err.name}, ${err.message}`);
                    }

                    // create a reference for the wake lock
                    // let wakeLock = null;

                    // // create an async function to request a wake lock
                    // const requestWakeLock = async () => {
                    //     try {
                    //         wakeLock = await navigator.wakeLock.request("screen");

                    //         // listen for our release event
                    //         wakeLock.addEventListener("release", () => {
                    //             // if wake lock is released alter the UI accordingly
                    //         });
                    //     } catch (err) {
                    //         // if wake lock request fails - usually system related, such as battery
                    //     }
                    // };

                    // wakeLockOnButton.addEventListener("click", () => {
                    //     requestWakeLock();
                    // });

                    // wakeLockOffButton.addEventListener("click", () => {
                    //     if (wakeLock !== null) {
                    //         wakeLock.release().then(() => {
                    //             wakeLock = null;
                    //         });
                    //     }
                    // });

                } else {
                    tileLayer.on('postrender', updateView);
                }
            })
            evtSource.addEventListener("update", async (event) => {
                let { iv, encrypted } = JSON.parse(event.data);
                iv = new Uint8Array(Object.values(iv))
                encrypted = new Uint8Array(Object.values(encrypted))

                const decrypted = await crypto.subtle.decrypt(
                    { name: "AES-GCM", iv },
                    key,
                    encrypted,
                );
                const decoded = new TextDecoder().decode(new Uint8Array(decrypted));
                const data = JSON.parse(decoded);

                let { position, accuracy, heading, speed, m, deltaMean } = data;
                addPosition(position, heading, m, speed);

                // const html = [
                //     'Position: ' + position[0].toFixed(2) + ', ' + position[1].toFixed(2),
                //     'Accuracy: ' + accuracy,
                //     'Heading: ' + Math.round(radToDeg(heading)) + '&deg;',
                //     'Speed: ' + (speed * 3.6).toFixed(1) + ' km/h',
                //     'Delta: ' + Math.round(deltaMean) + 'ms',
                // ].join('<br />');
                // document.getElementById('info').innerHTML = html;
                updateView()
            });
            evtSource.onerror = function (e) {
                console.error(e)
                evtSource.close();
                setupEventSource();
            };
        }
        setupEventSource();

        // Share must be triggered by "user activation"
        window.share_link.addEventListener("click", async () => {
            window.dialog.close()
            try {
                await navigator.share({
                    title: "Here's my location",
                    text: "Here's my location",
                    url: location.href
                });
                resultPara.textContent = "MDN shared successfully";
            } catch (err) {
                resultPara.textContent = `Error: ${err}`;
            }
        });

    </script>
</body>

</html>